<!Doctype html>

<html lang="es">
	<head>
		<meta charset="utf-8" />
		<title>Inicio</title>
		<link rel="stylesheet" href="css/edicion.css" />
        <script type="text/javascript" src="js/jquery.min.js"></script>
        <script type="text/javascript" src="js/jquery-ui.min.js"></script>

	</head>
	<body>
		<header>
			<h1>Encabezado</h1>
		</header>
        
        <section class = "barraH">
            <p>barra de herramientas</p>
        </section>
        
        <section class = "areaTrabajo">
            <div class ="herr">
                <p>Herramientas para el dise√±o</p>
                <button id="btnEntidad">Entidad</button>
            </div>

            <div id="canvas">
                <p>Area de Trabajo</p>

                <!--<table class="entidad draggable" >
                    <thead>
                        <tr class="caption">
                            <th class="table-name" colspan="2">Sin Titulo</th>
                        </tr>
                    </thead>
                    <tbody class="sortable">
                        <tr class="tr">
                            <td class="pk">PK</td>
                            <td>Atributo</td>
                        </tr>
                    </tbody>
                 </table>-->
            </div>

            <div class ="prop">
                <p>Opciones/Propiedades</p>
            </div>
        </section>
        
        
		
		<footer>
			<p>Sobre nosotros</p>
		</footer>



        <script>
            //Usado para identifacar a los objetos creados dinamicamente
            var objectID = 0;

            $("#btnEntidad").click(function () {
                $.ajax({
                    type: "GET",
                    url: "assets/paleta/entidad.xml",
                    dataType: "xml",
                    success: function (xml) {

                        var width = $(xml).find("entidad").attr("width");
                        var height = $(xml).find("entidad").attr("height");
                        var posX = $(xml).find("entidad").attr("x");
                        var posY = $(xml).find("entidad").attr("y");
                        var name = $(xml).find("entidad").attr("tableName");

                        var atributos = []

                        $(xml).find("atributo").each(function () {
                            atributos.push($(this).attr("name"));
                        })

                        //Crear la entidad y agregarla al area de trabajo
                        crearNuevaEntidad(width, height, posX, posY, name, atributos);

                    }
                });
            }
            );

            $(".draggable").draggable();
            $(".sortable").sortable();

            var crearNuevaEntidad = function (width, height, posX, posY, name, atributos) {
                var id = 'entidad' + objectID
                var htmltabla = '<table class="entidad draggable" id="' + id + '"><thead><tr class="caption"><th class="table-name" colspan="2">' + name + '</th></tr></thead><tbody class="sortable">'

                var i;
                for (i = 0; i < atributos.length; i++) {
                    var tr = '<tr class="tr"><td class="pk" style="width:10px">  </td><td>' + atributos[i] + '</td></tr>'
                    htmltabla = htmltabla.concat(tr);
                }

                htmltabla = htmltabla.concat('</tbody></table>');

                $("#canvas").append(htmltabla);

                $("#" + id).draggable();

                varObject++;

                //<table class="entidad draggable">
                //    <thead>
                //        <tr class="caption">
                //            <th class="table-name" colspan="2">Sin Titulo</th>
                //        </tr>
                //    </thead>
                //    <tbody class="sortable">
                //        <tr class="tr">
                //            <td class="pk">PK</td>
                //            <td>Atributo</td>
                //        </tr>
                //    </tbody>
                // </table>

            }


        </script>
	</body>
</html>